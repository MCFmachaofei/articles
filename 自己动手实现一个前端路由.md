### 前言  

用过现代前端框架的同学，对前端路由一定不陌生, vue, react, angular 都有自己的 router, 那么你对 router 的工作原理了解吗？
如果还不了解, 那么请跟我一起来手写一个简单的前端路由, 顺便了解一下.

### 实现路由的2种方式

1. hash模式
2. history模式

缺点:
hash：丑(地址栏要多一个#), 某些特殊场景有坑 ,如微信支付回调
history: 兼容性较差, 直接访问会400 ,除非后端或者服务器有做处理

### 基本原理

hash是基于 监听 hashchange 事件实现的，history 是基于 pushState 和 popState, 

### 实现

由于history兼容性较差，而且实现方式基本没多大区别，本文就以hash模式来实现，history的实现方式只实现不同的部分。

```html
<html>
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
<input type="button" onclick="hashPush('index')" value="goto index">
</body>
<script>
    // 页面跳转
    function hashPush(url) {
        location.hash = "#" + url
    }

    // 监听hash的变动
    window.addEventListener('hashchange', function (e) {
        console.log('当前的hash地址', location.hash.slice(1) || "/")
    })
</script>
</html>
```

以上就是hash模式的最简单实现，查看控制台，可以看到不管是点击跳转按钮，还是点击浏览器的前进／后退按钮，控制台都会输出当前的hash值，有了hash值，我们就可以根据hash值对内容做条件渲染了

我们在上面的代码的基础上，稍作修改一下，增加2个div,一个是login,一个是index

```html
<html>
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        body{
            margin: 0;
            padding: 0;
        }
        #login, #index{
            width: 100%;
            height: 100%;
            display: none;
        }

        #login{
            background: #f5f5f5;
            display: block;
        }

        #index{
            background: #aaddff;
        }
    </style>
</head>
<body>

<!--登录页-->
<div id="login" class="component">
    <input type="button" onclick="hashPush('index')" value="登陆">
</div>

<!--首页-->
<div id="index" class="component">
    <input type="button" onclick="hashPush('login')" value="退出登陆">
</div>

</body>
<script>

    // 页面跳转
    function hashPush(url) {
        location.hash = "#" + url
    }

    // 监听hash的变动
    window.addEventListener('hashchange', function (e) {
        let url = location.hash.slice(1) || "/"
        console.log('当前的hash地址', url)
        setVisible(url)
    })

    // 显示跟路由地址对应的内容，隐藏其他内容
    function setVisible(url) {
        let components = Array.from(document.body.querySelectorAll(".component"))
        components.map(item => {
            if(item.id===url) {
                console.log('显示',item.id)
                item.style.display = 'block'
            } else {
                console.log('隐藏',item.id)
                item.style.display = 'none'
            }

        })
    }
</script>
</html>

```

这样，我们就能根据不同的hash地址，显示不同的内容，是不是已经有点路由的味道了呢？ß
